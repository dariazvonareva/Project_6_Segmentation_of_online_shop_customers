# Построение модели сегментации клиентов онлайн-магазина подарков
## Оглавление
[1. Постановка задачи и цели проекта](https://github.com/dariazvonareva/Project_6_Segmentation_of_online_shop_customers/blob/main/README.md#Постановка-задачи-и-цели-проекта)
[2. Краткая информация о данных](https://github.com/dariazvonareva/Project_6_Segmentation_of_online_shop_customers/blob/main/README.md#Краткая-информация-о-данных)

[3. Этапы проекта](https://github.com/dariazvonareva/Project_6_Segmentation_of_online_shop_customers/blob/main/README.md#Этапы-проекта)

[4. Используемые инструменты](https://github.com/dariazvonareva/Project_6_Segmentation_of_online_shop_customers/blob/main/README.md#Используемые-инструменты)

[5. Результаты](https://github.com/dariazvonareva/Project_6_Segmentation_of_online_shop_customers/blob/main/README.md#Результаты)

### Постановка задачи

Маркетинг — неотъемлемая часть любого бизнеса. Для повышения прибыли компании важно понимать своего клиента, его пожелания и предпочтения.

Большинство интернет-магазинов используют инструменты веб-аналитики, чтобы отслеживать просмотры страниц, количество и поведение посетителей и коэффициент отказов. Но отчёта из Google Analytics или аналогичной системы может быть недостаточно для полного понимания того, как клиенты взаимодействуют с сайтом. Компаниям важно иметь возможность быстро и точно реагировать на перемены в поведении клиентов, создавая инструменты, которые обнаруживают эти изменения практически в режиме реального времени.

Машинное обучение помогает поисковой системе анализировать огромное количество данных о посетителях платформы, узнавать модели поведения профессиональных покупателей, определять категорию клиентов (например, лояльные/перспективные/новички/«спящие»/ушедшие) и выбирать правильную стратегию взаимодействия с ними.

##### Бизнес-задача: 
произвести сегментацию существующих клиентов, проинтерпретировать эти сегменты и определить стратегию взаимодействия с ними.

##### Техническая задача: 
построить модель кластеризации клиентов на основе их покупательской способности, частоты заказов и срока давности последней покупки, определить профиль каждого из кластеров.

##### Основные цели:
- Произвести предобработку набора данных.
- Провести разведывательный анализ данных и выявить основные закономерности.
- Сформировать категории товаров и клиентов.
- Построить несколько моделей машинного обучения, решающих задачу кластеризации клиентов, определить количество кластеров и проинтерпретировать их.
- Спроектировать процесс предсказания категории интересов клиента и протестировать вашу модель на новых клиентах.

:arrow_up:[к оглавлению](https://github.com/dariazvonareva/Project_6_Segmentation_of_online_shop_customers/blob/main/README.md#Оглавление)


### Краткая информация о данных

Данные представляют собой таблицу в формате .csv, в каждой строке которой содержится информация об уникальной транзакции.

Признаки, описывающие каждую транзакцию:

* *InvoiceNo* — номер счёта-фактуры (уникальный номинальный шестизначный номер, присваиваемый каждой транзакции; буква 'C' в начале кода указывает на отмену транзакции);
* *StockCode* — код товара (уникальное пятизначное целое число, присваиваемое каждому отдельному товару);
* *Descriptione* — название товара;
* *Quantity* — количество каждого товара за транзакцию;
* *InvoiceDate* — дата и время выставления счёта/проведения транзакции;
* *UnitPrice* — цена за единицу товара в фунтах стерлингов;
* *CustomerID* — идентификатор клиента (уникальный пятизначный номер, однозначно присваиваемый каждому клиенту);
* *Country* — название страны, в которой проживает клиент.

Источник датасета: (hhttps://archive.ics.uci.edu/)


### Этапы проекта
1. Знакомство со структурой данных
2. Преобразование, очистка и анализ данных
    2.1. Преобразование и очистка данных о транзакциях
    2.2. Разведывательный анализ данных о транзакциях
    2.3. Построение RFM-таблицы и поиск RFM-выбросов
3. Моделирование и оценка качества моделей
    3.1. Кластеризация на основе RFM-характеристик
    3.2. Интерпретация кластеров
4. Выводы и оформление работы


### Используемые инструменты:

#### RFM-таблица
С ее помощью мы формируем признаки, на основе которых мы будем производить сегментацию клиентов. Это популярный методом для анализа потребительской ценности под названием RFM. 

<center> <img src=https://miro.medium.com/max/1400/1*uYQjy9SUjW7iWHc2gGanQQ.png align="right" width="400"/> </center>

Метод заключается в группировке клиентов на основе следующих параметров:
* Recency (Давность) — давность последней покупки клиента;
* Frequency (Частота) — общее количество покупок клиента;
* Monetary Value (Денежная ценность) — сколько денег потратил клиент.


Суть RFM-анализа состоит в том, что мы разделяем всех клиентов на группы в зависимости от того, как давно они сделали последнюю покупку, как часто покупали и насколько большой была сумма их заказов. 

Например, вот так может выглядеть интерпретация кластеров для случая RF-сегментации (анализа на основе давности и частоты заказов клиента):

<img src=https://retailrocket.ru/wp-content/uploads/2017/06/rfm-1.png>

Задача маркетологов — вести клиента в зону лояльных.

Мы можем рассчитать RFM-характеристики для каждого из клиентов в нашем датасете и на их основе с помощью методов кластеризации построить подобные сегменты клиентов, привязанные к нашим данным.

#### Профиль кластеров


Чтобы результаты было проще интерпретировать, давайте познакомимся с одним из способов визуализации профиля кластеров — **Radar Chart** (полярная диаграмма, или диаграмма паутины). Это графическое представление значений нескольких эквивалентных категорий в форме паутины.

Radar Chart часто используется при определении профиля кластеров. На концах паутины откладываются оси, соответствующие признакам, описывающим объекты. На каждой из осей для каждого кластера откладываются средние значения соответствующих характеристик. Соединив точки по осям, мы получаем многоугольник. 

Пример полярной диаграммы для задачи кластеризации учеников по интересам:

<img src=https://www.datanovia.com/en/wp-content/uploads/2020/12/radar-chart-in-r-customized-fmstb-radar-chart-1.png width=500>

На этой диаграмме мы видим визуализацию признаков для одного из кластеров. Видно, что ученики, принадлежащие этому кластеру, в большей степени увлекаются музыкой (Music), а в меньшей — программированием (Programm).

В модуле `graph_objects` библиотеки `plotly` есть встроенная функция `Scatterpolar`, которая позволяет построить полярную диаграмму. На основе этой функции мы подготовили для вас функцию `plot_cluster_profile()`, которая позволяет визуализировать профиль каждого из кластеров в виде полярной диаграммы. У неё есть два параметра: `grouped_data` — сгруппированные по кластерам характеристики объектов (клиентов), `n_clusters` — количество кластеров.

#### Библиотека Scikit-learn

Классические методы кластеризации: метод Kmeans, метод ЕМ-кластеризации на основе Гауссовой смеси (GaussianMixture), Аггломеративная Иерархическая кластеризация (AgglomerativeClustering). Также в качестве метрики оценки качества используемого алгоритма применялся silhouette_score.


### Результаты:
[Ноутбук с выполненными заданиями и выводами](https://github.com/dariazvonareva/Project_6_Segmentation_of_online_shop_customers._%D0%9D%D0%BE%D1%83%D1%82%D0%B1%D1%83%D0%BA-%D1%88%D0%B0%D0%B1%D0%BB%D0%BE%D0%BD.ipynb)

:arrow_up:[к оглавлению](https://github.com/dariazvonareva/Project_6_Segmentation_of_online_shop_customers/blob/main/README.md.md#Оглавление)
